<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hertz Frequencies - Gravity</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;600&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Gowun+Dodum&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
</head>

<body>
    <a href="index.html#step-3" class="back-btn hertz-back-btn">
        <span class="arrow">←</span> Go Back
    </a>



    <!-- Page Transition Overlay (Starts active for fade-in effect) -->
    <div id="page-transition-overlay" class="active"></div>

    <div class="hertz-container">
        <h1>Hertz Frequencies
            <span class="info-trigger">?
                <span class="info-tooltip">
                    Sound frequencies like 396 Hz can influence brainwave activity, shifting the mind from a state of
                    anxiety to relaxation. This helps in releasing subconscious fear and guilt, facilitating emotional
                    grounding and balance.
                    <br><br>
                    <span class="korean-text">
                        396Hz와 같은 음향 주파수는 뇌파 활동에 영향을 주어, 불안한 마음을 이완된 상태로 변화시킵니다. 이는 잠재의식 속의 두려움과 죄책감을 덜어내어 정서적 안정과 균형을
                        찾는 데 도움을 줍니다.
                    </span>
                </span>
            </span>
        </h1>
        <h2>396 Hz — Anxiety Release</h2>

        <!-- Audio Controls -->
        <div class="hertz-controls">
            <button id="play-btn" class="control-btn">&#9658;</button>
            <button id="pause-btn" class="control-btn">&#10074;&#10074;</button>
        </div>

        <!-- Timer Controls -->
        <div class="timer-section">
            <div class="timer-buttons">
                <span class="timer-label">Set Timer:</span>
                <button class="timer-btn" data-time="10">10m</button>
                <button class="timer-btn" data-time="15">15m</button>
                <button class="timer-btn" data-time="20">20m</button>
            </div>
            <div id="timer-display" class="timer-display hidden">00:00</div>
            <button id="cancel-timer" class="cancel-timer-btn hidden">✕</button>
        </div>

        <!-- Water Drop Animations (Multiple Sources) -->
        <div class="water-animation main-water" id="water-1"></div>
        <div class="water-animation small-water" id="water-2"></div>
        <div class="water-animation medium-water" id="water-3"></div>
        <div class="water-animation tiny-water" id="water-4"></div>
        <div class="water-animation extra-water-1" id="water-5"></div>
        <div class="water-animation extra-water-2" id="water-6"></div>

    </div>

    <!-- SoundCloud Widget -->
    <iframe id="sc-player" width="100%" height="166" scrolling="no" frameborder="no" allow="autoplay"
        src="https://w.soundcloud.com/player/?url=https%3A//soundcloud.com/musicfromthefirmament/sets/396-hz-solfeggio-frequency-meditation-eliminates-fear&color=%23ff5500&auto_play=false&hide_related=true&show_comments=false&show_user=false&show_reposts=false&show_teaser=false&visual=false"
        style="display: none;">
    </iframe>
    <script src="https://w.soundcloud.com/player/api.js"></script>

    <script>
        // Page Transition Logic
        document.addEventListener('DOMContentLoaded', () => {
            const overlay = document.getElementById('page-transition-overlay');
            const playBtn = document.getElementById('play-btn');
            const pauseBtn = document.getElementById('pause-btn');
            const waterContainers = document.querySelectorAll('.water-animation');

            // Timer Elements
            const timerButtons = document.querySelectorAll('.timer-btn');
            const timerDisplay = document.getElementById('timer-display');
            const cancelTimerBtn = document.getElementById('cancel-timer');
            let timerInterval;

            let widget;
            let rippleIntervals = [];

            const iframe = document.getElementById('sc-player');

            // Fade out page transition overlay
            setTimeout(() => {
                overlay.classList.remove('active');
            }, 100);

            // Initialize SC Widget
            function initWidget() {
                if (typeof SC !== 'undefined') {
                    widget = SC.Widget(iframe);
                } else {
                    setTimeout(initWidget, 100);
                }
            }
            initWidget();

            // Ripple Generator Logic
            function spawnRipple(container) {
                const ripple = document.createElement('div');
                ripple.classList.add('ripple');
                container.appendChild(ripple);

                // Remove after animation (4s)
                setTimeout(() => {
                    ripple.remove();
                }, 4000);
            }

            function startRipples() {
                if (rippleIntervals.length === 0) {
                    // Main Water (Steady Pulse)
                    spawnRipple(waterContainers[0]);
                    rippleIntervals.push(setInterval(() => spawnRipple(waterContainers[0]), 800));

                    // Small Water (Slower)
                    rippleIntervals.push(setInterval(() => spawnRipple(waterContainers[1]), 1200));

                    // Medium Water (Very Slow)
                    rippleIntervals.push(setInterval(() => spawnRipple(waterContainers[2]), 2000));

                    // Tiny Water (Fast Flutter)
                    rippleIntervals.push(setInterval(() => spawnRipple(waterContainers[3]), 600));

                    // Extra Water 1 (Medium-Slow)
                    rippleIntervals.push(setInterval(() => spawnRipple(waterContainers[4]), 1500));

                    // Extra Water 2 (Medium-Fast)
                    rippleIntervals.push(setInterval(() => spawnRipple(waterContainers[5]), 900));
                }
            }

            function stopRipples() {
                rippleIntervals.forEach(interval => clearInterval(interval));
                rippleIntervals = [];
            }


            // Play/Pause Controls
            playBtn.addEventListener('click', () => {
                if (widget) {
                    widget.play();
                    startRipples();
                }
            });

            pauseBtn.addEventListener('click', () => {
                if (widget) {
                    widget.pause();
                    stopRipples();
                }
            });

            // Timer Logic
            timerButtons.forEach(btn => {
                btn.addEventListener('click', () => {
                    const minutes = parseInt(btn.getAttribute('data-time'));
                    startTimer(minutes);

                    // Auto play if not playing
                    if (widget) {
                        widget.play();
                        startRipples();
                    }
                });
            });

            cancelTimerBtn.addEventListener('click', stopTimer);

            function startTimer(minutes) {
                clearInterval(timerInterval);
                let seconds = minutes * 60;

                updateDisplay(seconds);
                timerDisplay.classList.remove('hidden');
                cancelTimerBtn.classList.remove('hidden');

                timerInterval = setInterval(() => {
                    seconds--;
                    updateDisplay(seconds);

                    if (seconds <= 0) {
                        clearInterval(timerInterval);
                        stopTimer(); // Reset UI

                        // Stop Session
                        if (widget) {
                            widget.pause();
                            stopRipples();
                        }
                    }
                }, 1000);
            }

            function stopTimer() {
                clearInterval(timerInterval);
                timerDisplay.classList.add('hidden');
                cancelTimerBtn.classList.add('hidden');
            }

            function updateDisplay(totalSeconds) {
                const m = Math.floor(totalSeconds / 60);
                const s = totalSeconds % 60;
                timerDisplay.textContent = `${m.toString().padStart(2, '0')}:${s.toString().padStart(2, '0')}`;
            }

            // Handle Back Button
            const backBtn = document.querySelector('.back-btn');
            backBtn.addEventListener('click', (e) => {
                e.preventDefault();
                const target = backBtn.getAttribute('href');
                overlay.classList.add('active');
                setTimeout(() => {
                    window.location.href = target;
                }, 500);
            });
        });
    </script>
</body>

</html>